
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="I recently had an interview in which I was asked, &#8220;how many ways can 1000 dice make the sum 3000?&#8221; I was caught a little off-guard, and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dlecocq.github.com/blog/page/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39246569-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My Octopress Blog</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dlecocq.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/05/10/sum-of-dice/">Sum of Dice</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-05-10T00:00:00-07:00" pubdate data-updated="true">May 10<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">I recently had an interview in which I was asked, &#8220;how many ways can 1000 dice make the sum 3000?&#8221; I was caught a little off-guard, and the phrasing made me wonder about a closed-form solution which, after some reading, I don&#8217;t believe exists. Still, a workable solution isn&#8217;t as easy as that.

Let <em>F(n, k)</em> denote the number of ways <em>n</em> dice can make the sum <em>k</em>. Note that the first die can be 1, 2, 3, 4, 5 or 6, so <em>F(1000, 3000) = F(999, 2999) + F(999, 2998) + &#8230; + F(999, 2994)</em>. While this recurrence relation leads to an easy implementation, it suffers from two big problems: performance and maximum recursion depth. Without any <a href="http://en.wikipedia.org/wiki/Memoization">memoization</a> or optimization, this would lead to 6<sup>1000</sup> function calls, which is about 10<sup>780</sup>. That&#8217;s a big number. If you were able to evaluate one such function call every clock cycle on every computer in the world (about 7 x 10<sup>18</sup> cycles/second), you would need about 10<sup>750</sup> years, or 10<sup>650</sup> lifetimes of the universe (about 10<sup>100</sup> years) to solve it. Get ready to wait.

One optimization is to check if the arguments n and k make sense at each level, and prune accordingly. For example, n dice can only sum to between n and 6n, so if k is outside of that range, you don&#8217;t need to branch down any farther. Even using this and instantaneous branch evaluation, your code still wouldn&#8217;t complete in the expected lifetime of the universe.

Obviously, this is still a solvable problem (there are about 10<sup>757</sup> ways 1000 dice can sum to 3000). A python implementation figured that out in 3.5 seconds. One way to help crack this egg is to use memoization. Consider the calls to <em>F(999, 2999)</em> and <em>F(999, 2998)</em>. Expand these out to get:
<ul>	
<li><em>F(999, 2999) = sum[F(998, k = 2998, 2997, 2996, 2995, 2994, 2993)]</em></li>
<li><em>F(999, 2998) = sum[F(998, k = 2997, 2996, 2995, 2994, 2993, 2992)]</em></li>
</ul>
You&#8217;ll notice that both of these expansions call <em>F(998, k = 2997, 2996, 2995, 2994, 2993)</em>, each of which is a <em>lot</em> of work to evaluate. So, if once you determined each of these values once, you could use them in other places and save huge amounts of time.

One thing you&#8217;d need in order to implement memoization is a map (or dictionary in python) that stores key-value pairs. So once you figure out <em>F(998, 2997)</em>, you could store it like <em>myMap[(998, 2997)] = &#8230;</em>; but this can add some complication. Every time to call F, you&#8217;d have to check if you&#8217;ve already evaluated the function for those arguments. And when you&#8217;ve figured out and stored a lot of these values, each search will take some time. It will still work and will get you the answer you need, but probably not as fast as you&#8217;d like, and not as fast as it could be. Using memoization for <em>F(700, 2100)</em> took 8.2 seconds in a python implementation, but a better approach took 1.5 seconds. The maximum recursion depth prevented it from using bigger numbers.

Algorithmically, the best you&#8217;ll be able to do (as far as I can tell) is <em>O(n<sup>2</sup>)</em>, which is not bad in the scheme of things, and certainly not the combinatoric time we saw first. Enter dynamic programming. Particularly, we&#8217;ll use a <a href="http://en.wikipedia.org/wiki/Top-down_and_bottom-up_design">bottom-up approach</a>. We&#8217;ll build two arrays, each associated with a number of dice. The <em>i</em>&#8216;th index in that array is the number of ways n dice can sum up to <em>(n + i)</em>. So for 1 die, <em>myArray[0]</em> is the number of ways you can roll a 1, and for 4 dice, <em>myArray[10]</em> would be the number of ways you can roll 4 dice to get 14.

As I said, we&#8217;ll keep track of two arrays, say <em>previous</em> and <em>current</em>. First, initialize previous to be the number of ways 1 die can be rolled: <em>{1, 1, 1, 1, 1, 1}</em>, because 1 die can be rolled each number in only one way. Then, we&#8217;ll use that to fill the array &#8220;current&#8221; with the number of ways 2 dice can be rolled, based on the array <em>previous</em>. For example, <em>current[0] = previous[0] = 1</em>, because the only way to get a sum of n with n dice is to roll all 1&#8217;s. Then, <em>current[1] = previous[0] + previous[1]</em>, because if we roll a 2 for the second dice, there are <em>previous[0]</em> ways to sum up to 1 with the remaining die, or if we roll a 1 for the second dice, there are <em>previous[1]</em> ways to sum up to 2 with the remaining die.

Each entry <em>current[i]</em> should be the sum of <em>previous[i-5, i-4, i-3, i-2, i-1, i]</em>, taking the bounds of the previous array into consideration (this can actually be generalized to any <em>m</em>-sided dice by using previous[i-m+1, &#8230;, i]). Once you&#8217;ve filled the array <em>current</em>, then you assign current to previous, and move on to the next number of dice, 3. Continue this until you have filled the array for the desired number of dice. If performance is a big issue, this can be implemented as a moving frame. For example, since <em>current[i]</em> uses <em>previous[i-5, &#8230;, i]</em> and <em>current[i+1]</em> uses <em>previous[i-4, &#8230;, i+1]</em>, you can alternatively write <em>current[i+1] = current[i] - previous[i-5] + previous[i+1]</em>, and use only two add/subtract operations instead of 5.

A bonus to this bottom-approach is that once finished, you actually have an array with the number of ways you can make <em>any</em> sum with the <em>n</em> dice. This makes it easy if you wish to find the number of ways <em>n</em> dice can form a sum <em>up to</em> or <em>greater than</em> a number.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/05/10/numerical_limits/">Numerical_limits</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-05-10T00:00:00-07:00" pubdate data-updated="true">May 10<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">I&#8217;m working on a C++ class that encapsulates changes to a &#8220;steerable&#8221; variable. It&#8217;s part of a system that allows trusted commands from a socket library to change the value of registered variables. For example, a client might:
<code>
int sInt(0);
float sFloat(0.3);
registerParam("someSteerableInteger", &sInt);
registerParam("someSteerableFloat", &sFloat);
...
// Library makes these calls after receiving remote commands:
setParam("someSteerableInteger", 5);
setParam("someSteerableFloat", 3.4);
</code>

There&#8217;s some intelligence in the class to ensure integrity of the data. For example, it will cast the value past into <em>setParam(&#8230;)</em> correctly, so that a call to <em>setParam(&#8220;someSteerableInteger&#8221;, 5.3)</em> results in the 5.3 cast as an integer and then used to set the integer&#8217;s value.

Some of the other intelligence needed is that the user might specify the minimum and maximum valid values the variable might take on. Or he or she might not. If not, it would be nice to have a convenient way of specifying a reasonable default minimum and maximum.

Enter <em><a href="http://www.cplusplus.com/reference/std/limits/numeric_limits/">numerical_limits</a></em>. It&#8217;s a static templated class that can give you some insight into the built-in types. For example:
<code>
#include &lt;iostream&gt;
#include &lt;limits&gt;
using namespace std;
...
cout &lt;&lt; "Min unsigned int: " &lt;&lt; numerical_limits&lt;unsigned int&gt;::min() &lt;&lt; endl;
cout &lt;&lt; "Max float: " &lt;&lt; numerical_limits&lt;float&gt;::max() &lt;&lt; endl;
</code>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/02/24/wrapping-printf/">Wrapping Printf(1)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-24T00:00:00-08:00" pubdate data-updated="true">Feb 24<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">Working on an application that had become a little&#8230; verbose, I decided it was finally time to wrap my prints in a function that could easily be switched on or off depending on whether or not I wanted it to be verbose.  One approach I had seen before (from my OS professor) that has a certain amount of merit is to wrap statements with a macro:
<code>
#ifdef DEBUG
printf(....);
#endif
</code>

The nice thing about this approach is that debugging can be turned on or off easily at compile time.  However, my experience has been that it leads to a lot of typing, and seeing too many macros in the middle of code makes my brain explode in a fiery rage.  So, I figured that if I wrapped my prints in another function (I called mine &#8216;log&#8217; and &#8216;error&#8217;), I could avoid this whole mess and keep my sanity.  I&#8217;ve done this with a number of other projects in other languages, but I had to learn some magic to do it in C.

Lesson Learned #1 : Variable arguments. It turns out you can define functions that take a variable number of arguments with <em>va_list</em> (from <a href="http://en.wikipedia.org/wiki/Stdarg.h"><stdarg.h></a>).  You define such a function:
<code>
void log(const char* fmt, ...) {
    va_list args;
    va_start(args, fmt);
    ...
    va_end(args);
}
</code>

Lesson Learned #2 : However, from what I can gather, you can&#8217;t just inject printf directly into this. However, having anticipated this, there is a set of functions designed for cases like this: <em>vfprintf, vprintf, vsnprintf, vsprintf</em>. The &#8216;v&#8217; stands for va_list (variable-argument list), and you can use them just like you&#8217;d expect:
<code>
void log(const char* fmt, ...) {
    va_list args;
    va_start(args, fmt);
    fprintf(log_fd, "NOTE : ");
    vfprintf(log_fd, fmt, args);
    va_end(args);
}
</code>

The thing I like about this approach is that you have control over how log messages get printed in <em>one</em> place.  So, for example, if I provided another function, <em>setLogFD</em>, then I could easily just set the file descriptor where all log messages get printed.  So easy!  Something I&#8217;ve used this for in other instances (especially servers) is to also inject additional information like a timestamp on every message.  So, when I call:
<code>
log("Some event '%s' just happened.\n", event_name);
</code>

Then I automatically get &#8220;NOTE : &#8221; and maybe a timestamp prefixed on that message.  Which make code look clean, and adds a great deal of functionality.  I actually added another function <em>error(&#8230;)</em> that prints to a different file descriptor in case I want to suppress debug messages, but no error messages.  For additional layers of debugging, you might do something like this:
<code>
void log(int level, const char* fmt, ...) {
    va_list args;
    va_start(args, fmt);
    FILE* fd = my_log_files[level];
    fprintf(fd, "NOTE : ");
    vfprintf(fd, fmt, args);
    va_end(args);
}
</code>

This way, at startup, you could easily set some of the file descriptors in <em>my_log_files</em> to stderr and some to point to /dev/null or otherwise dissolve into the ether.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/11/25/rename2/">Rename(2)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-25T00:00:00-08:00" pubdate data-updated="true">Nov 25<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content">I found myself needing to systematically rename a bunch of files, and previously the only way I knew to do it was with a loop, passing each filename into sed, and using the output as the destination filename.  Tedious and error prone!

However, it turns out that people have anticipated this use case, and there is a utility for this exact purpose, called &#8220;rename.&#8221;  It allows you to provide a perl-style regular expression whose input is the existing filename found by your search expression, and whose output is what that file should be renamed.  There&#8217;s even an <em>especially useful option</em> to take no action, but only to print out what the new filenames would be, allowing you to perform a dry-run before you rename 100000 files.

Example:
<code>
rename -n 's/^/some.file.prefix./' *.jpg
</code>

Happy renaming!
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/09/22/spokepov/">SpokePOV</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-22T00:00:00-07:00" pubdate data-updated="true">Sep 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content">When moving to Saudi Arabia, it is important to bring hobbies. Some have video games. Others learn to dive or windsurf. Considering this fact when returning this most recent time, I bought a <a href="http://www.ladyada.net/make/spokepov/">SpokePOV kit</a> from the nice folks at <a href="http://adafruit.com/">adafruit industries</a>.

Short story is it works by attaching these microcontroller-controlled strips of LEDs to the spokes of your bike tire.  These then monitor the rate at which the wheels are moving (they sense a magnet places on the fork), and based on that, quickly turn on and off the various LEDs to form a pattern.  If the wheel then spins fast enough, then your eyes perceive it as a static image.  A long exposure does the same trick:

<a href="http://www.flickr.com/photos/danlecocq/5014080439/" title="DSC_0002.NEF by danlecocq, on Flickr"><img class="aligncenter" src="http://farm5.static.flickr.com/4090/5014080439_5591e3bb9c.jpg" width="500" height="334" alt="DSC_0002.NEF" /></a>

It took maybe 7 or 8 hours of soldering (it was a slow start initially), and worked right off the bat.  That is something I was particularly pleased with, as in my chosen field, code very rarely works correctly the first time.

Unfortunately over the summer my soldering iron disappeared from my apartment, and so I went looking for a new one.  Our local supermarket, Tamimi (the Saudi Safeway franchise) sells soldering irons, but does not sell solder.  Finding suitable solder was the mission of three days of biking back and forth between campus and downtown Thuwal.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/24/falling-to-the-earth/">Falling to the Earth</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-24T00:00:00-07:00" pubdate data-updated="true">Aug 24<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content">Earlier this summer, I agreed to go skydiving with my friend Chris.  Yesterday, we finally took the jump.

<a href="http://www.mile-hi-skydiving.com/">Mile-Hi Skydiving</a> is only about 20 minutes from where my parents live, and accept walk-ins.  We showed up, signed away our lives and after a wait (after all, we didn&#8217;t make reservations), we were introduced to the instructors we&#8217;d be strapped to.  I can&#8217;t speak for Chris, but the guy helping me out, Dave, was disconcertingly quiet when getting set up.  He handed me a suit, and helped me put on a harness that loops around each leg, the torso and finally straps over the shoulders.

After a short wait, a truck with a flatbed trailer drove up, and about 12 people hopped on.  There were two other people in our group making a tandem dive, as well as a few others making solo jumps (including one guy wearing a <a href="http://en.wikipedia.org/wiki/Wingsuit_flying">squirrel suit</a>).  We drive up to a plane whose propeller is roaring making it difficult to hear the guy next to you, and are packed into two benches facing each other.  At this point the reality of the situation really began to hit me, and was compounded by the fact that the guy I would tumble to the ground with hadn&#8217;t yet told me anything that would be happening!

We were cleared for takeoff and began to climb.  A few more experienced guys at the back held the door open for a while during our ascent, and it was relatively unsettling to see an open door on a plane like that.  Eventually Dave told me to sit on his lap and he began hooking my harness to him and his parachute and tightening straps.  &#8220;When we go out, don&#8217;t jump &#8211; I&#8217;m going to push you.  Hold on here, and tuck your legs back and I&#8217;ll let you know when you can let go.&#8221;  At this point, the solo jumpers were beginning to hop out.  Dave hands me goggles and we move towards the door, and before I realize it, we&#8217;re tumbling out of a plane.

Instantly the speed of wind rushing past registers, thick as soup.  Trying to concentrate, I remember to tuck my legs back and Dave locks legs to position us correctly, turning us ever so often to admire the view.  It really was akin to zooming in on Google Earth, except for the attenuation of light from the distance, and the freezing air flapping violently at you.  From Longmont&#8217;s Vance Brand Airport, we could see Boulder and Longmont laid out in front of us.  I had expected that during freefall I would feel the same feeling in my stomach as when an airplane experiences turbulence, or an elevator sometimes jolts.  The feeling of gravity giving out, and the instinct to grab onto something.  Though, after the first few seconds (during which we were tumbling) there was nothing of the sort.

After about a minute, I felt Dave reach for something and I figure it&#8217;s him deploying the parachute.  For a split second I wondered what to anticipate, and then I felt a strong tug upwards and suddenly we were upright.  He adjusted my straps for this position, which felt a bit like being unharnessed.  I took on a sitting position in the harness and enjoyed the view when Dave began, &#8220;let&#8217;s talk about the landing.&#8221;

It was another couple of minutes before we finally touched down, and it was all a bit too much to take in during one jump.  On the flight up, I was certain that I would never try this a second time, but now, I have a feeling it won&#8217;t be the last time I jump out of a perfectly good airplane.

I highly recommend the experience to anyone and everyone.  Especially as some have recently been <a href="http://lifehacker.com/5608980/spend-on-experiences-instead-of-possessions-for-longer-happiness">suggesting that experiences are more enjoyed than possessions</a>.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/22/mpi_datatype/">MPI_Datatype</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-22T00:00:00-07:00" pubdate data-updated="true">Aug 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content">It has been a while since I&#8217;ve had to work with MPI, but recently I had to learn a new trick with it.  MPI provides ways to convey data between processes in a number of ways, from broadcasts to scatters to all-gathers.  But obviously you have to provide a certain amount of information about the structure of the data, not the least of which is the datatype.

MPI defines enumerated constants for the basic data types in C: MPI_CHAR, MPI_INT, etc., and for the most part these will suffice.  But what if you want to scatter your own struct?  This can be done through a number of utility functions, but the most versatile seems to be MPI_Type_struct().

You let MPI know how many different blocks, or chunks of memory there are, their lengths, their offsets and types, and then what variable to store the resulting integer handle in.  So if we had a struct:

<code>
typedef struct {
    int var;
    char string[STRING_LENGTH];
    double foo;
} bar;
</code>

We would first indicate that there are three blocks, of lengths 1, STRING_LENGTH and 1:
<code>
int count = 3;
int lengths[3] = {1, STRING_LENGTH, 1};
</code>

The offsets indicate the byte offsets from the base address of each of the types in the structure.  For this example, the &#8220;var&#8221; variable is the first, and thus has offset 0.  On the other hand, &#8220;string&#8221; will have an offset that is sizeof(int), and &#8220;foo&#8221; will appear after the int and the string of length STRING_LENGTH:
<code>
MPI_Aint offsets[3] = {0, sizeof(int), sizeof(int) + STRING_LENGTH};
MPI_Dataype types[3] = {MPI_INT, MPI_CHAR, MPI_DOUBLE};
</code>

To finish up, we ask MPI to fill an integer we declare with the handle that will hereafter refer to this struct for the purposes of MPI.  Then, we commit it, and it&#8217;s ready for use!
<code>
/* Corrected by commenter `tinku`: int -> MPI_Datatype */
MPI_Datatype barDatatype;
MPI_Type_struct(count, lengths, offsets, types, &barDatatype);
MPI_Type_commit(&barDatatype);
</code>

Now if you have an array of bar structs, you can use scatterv with it and your new datatype, or bcast for that matter.  It&#8217;s business as usual, as if it were any of the include base datatypes in MPI.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/20/ipad/">iPad</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-20T00:00:00-07:00" pubdate data-updated="true">Aug 20<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content">A few weeks ago, I got myself an iPad.  Ebook readers are well and good in principle, but as my friend Tyler pointed out, for technical papers and books that are rife with figures, it becomes necessary to zoom in and out, and ebook readers just aren&#8217;t there yet.  Plus, this gives me the internet, directions, my news, email, pictures, and movies on long flights (which have become a part of living in Saudi Arabia).

Getting the device, however, proved interesting.  I had originally planned to get one almost two months ago, and called up the 5th Avenue Apple store around 11 at night, thinking it would be less busy.  They&#8217;re open 24/7, and the idea of walking into the store in the middle of the night and buying a device held a certain appeal.  After 20 minutes on hold, I talked to a guy, and asked him if they had any in stock (after all, it&#8217;s kind of a long walk).  He sort of laughed, said &#8216;no,&#8217; and that I&#8217;d have to make an appointment to buy one.  This didn&#8217;t seem right to me, but it was late and I wasn&#8217;t in the mood to deal with a smarmy Apple employee.

A few weeks after that, I figured I&#8217;d bike down to the Upper West Side store, figuring out that it would be faster to ride there than to wait on hold.  I asked if they had stock, and someone told me they did, and that he&#8217;d go back and get it.  Then, 15 minutes later he returns saying he was mistaken.  Then, I zip off to the 5th Ave store, where it&#8217;s the same story.  Then downtown to the 14th St. store, and eventually the SoHo store.  Nothing.  And, it was actually faster to bike to every Apple store in Manhattan than to call them.

It wasn&#8217;t until two weeks after that when I drove up to New Hampshire to see my sister that I was finally able to get one.  I called her campus book store, and they had everything in stock.  And to boot, there&#8217;s no sales tax there.  A 10-minute phone call (and a five-hour drive I was making anyway) later, I finally had an iPad.  Such an ordeal!

In the end, I wonder, why does Apple make it so hard to love them?  All I want to do is buy their latest polished turd of a device.  That said, I really have been enjoying the hell out of it.  But the spite is growing, Apple.  The spite is growing.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/13/promises-to-my-os-prof/">Promises to My OS Prof</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-13T00:00:00-07:00" pubdate data-updated="true">Aug 13<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content">For me, operating systems was one of the most worth-while courses in my undergraduate career.  Not only gaining insight into the black-box that can be the operating system, but learning a bunch of skills that I have found invaluable since then.

Even in graduate school, I encounter computer scientists that have never used the command line.  While its all well and good to use your IDE, it is absolutely crippling to not be able to do all the same magics from the command line.  Not only that, but there is a wealth of tools accessible from your favorite shell and bash scripting is a useful piece to keep in one&#8217;s toolbox.  The command line was one thing with which I was better acquainted through operating systems; this was especially true in one project where we had to roll our own shell.  This was particularly good because the shell gives access to a lot of system tools that I&#8217;ve since found I want to use in other programs: forking, dup&#8217;ing, interacting with environment variables, etc.

Other good experiences were working with threading libraries and even booting up EC2 instances and testing out code there.  I am extremely grateful to then-professor Mike Colagrosso for making it such a worthwhile experience.  Lately I&#8217;ve been working with code where I remember quality code promises he made us make:

<strong>ALWAYS save the return value of system calls.</strong>  I try to avoid programming in C as much as possible (after all, C++ is usually an alternative, if not Python), but whenever I do I am constantly reminded of this one.  The most common design for functions that I encounter in that kind of code is to accept the variable that is to be updated, and return instead, a code indicating the success/failure/warnings/etc. of the code.  In some cases, the return value is the only way you&#8217;ll have access to the resource just requested (for example in the case of fork(2) ), but either way it&#8217;s the basic mechanism for getting feedback about how code has executed.

<strong>NEVER use strcpy(3).</strong> I&#8217;ve never used a buffer overflow in a clever way (though this is a someday project), or I should say on purpose.  But I&#8217;ve dealt with enough instances of me being distracted and writing bad code that I&#8217;ve gotten to know gdb (the GNU DeBugger) better than I would like.  The strcpy(3) function relies on null character termination to stop copying memory from one string into another.  If, however, a string isn&#8217;t null terminated or isn&#8217;t terminated before the length of the string buffer being copied into, then the operation will overrun the buffer.  Instead, <strong>ALWAYS use strncpy(3)</strong>.  It allows you to specify the maximum length that should be copied (like, for instance the length of the buffer being copied into) so as to avoid this embarrassing problem.

Despite the taking the class just over three years ago (it&#8217;s unsettling to realize its been so long), these few promises have stuck with me.  So Mike, if you&#8217;re reading this, I&#8217;m doing my part!
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/04/a-bad-first-instinct/">A Bad First Instinct</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-04T00:00:00-07:00" pubdate data-updated="true">Aug 4<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content">It&#8217;s an itch.  A compulsion.  Sometimes when working with a new library I get a very strong impulse to do a very bad thing &#8211; reinvent the wheel.  Or, in this case, re-write the wheel.

It&#8217;s easy to object to the way code is organized, and can cause a certain amount of discomfort.  Whether it&#8217;s the desire to go through and reformat code (braces belong on the same line as the if statement!) or the pain of hacking together relatively incompatible library designs, it can be unpleasant.

Something that I&#8217;ve been pushing myself to do, and slowly learning to do is to be comfortable with that discomfort.  To resist the urge to rewrite code, as it&#8217;s never just a matter of rewriting it, but also testing it, an so forth.  I&#8217;m slowly beginning to accept the painful truth: no code is perfect.

That said, there are times when I do rewrite libraries.  Sometimes you&#8217;re handed code from ten years ago that&#8217;s no longer applicable, or antiquated, or just plain ugly.  In these scenarios it&#8217;s perfectly justified to make large sweeping structural changes (with the protection of your favorite version control, of course).  Just, hold off.  Wait, and try to use the library, and the first-pass issues will either grow into systemic problems or wither and recede into the cracks.
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/5/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/10/11/running-sudo-with-pssh/">Running sudo with pssh</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/21/rough-array-hash-benchmark/">Rough Array Hash Benchmark</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/20/taskmaster-from-disqus/">Taskmaster from DISQUS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/18/seomoz-blog-post-introducing-qless/">SEOmoz Blog Post &#8211; Introducing qless</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/11/redis-and-lua-for-robust-portable-libraries/">Redis and Lua for Robust, Portable Libraries</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/dlecocq">@dlecocq</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'dlecocq',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
