
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="A few weeks ago, I got myself an iPad. Ebook readers are well and good in principle, but as my friend Tyler pointed out, for technical papers and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dlecocq.github.com/blog/page/5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39246569-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



  <!-- MathJax -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>

  <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
  </script>

  <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });
  </script>

  <script type="text/javascript"
     src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My Octopress Blog</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dlecocq.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/20/ipad/">iPad</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-20T00:00:00-07:00" pubdate data-updated="true">Aug 20<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A few weeks ago, I got myself an iPad.  Ebook readers are well and good in principle, but as my friend Tyler pointed out, for technical papers and books that are rife with figures, it becomes necessary to zoom in and out, and ebook readers just aren’t there yet.  Plus, this gives me the internet, directions, my news, email, pictures, and movies on long flights (which have become a part of living in Saudi Arabia).</p>

<p>Getting the device, however, proved interesting.  I had originally planned to get one almost two months ago, and called up the 5th Avenue Apple store around 11 at night, thinking it would be less busy.  They’re open 24/7, and the idea of walking into the store in the middle of the night and buying a device held a certain appeal.  After 20 minutes on hold, I talked to a guy, and asked him if they had any in stock (after all, it’s kind of a long walk).  He sort of laughed, said ‘no,’ and that I’d have to make an appointment to buy one.  This didn’t seem right to me, but it was late and I wasn’t in the mood to deal with a smarmy Apple employee.</p>

<p>A few weeks after that, I figured I’d bike down to the Upper West Side store, figuring out that it would be faster to ride there than to wait on hold.  I asked if they had stock, and someone told me they did, and that he’d go back and get it.  Then, 15 minutes later he returns saying he was mistaken.  Then, I zip off to the 5th Ave store, where it’s the same story.  Then downtown to the 14th St. store, and eventually the SoHo store.  Nothing.  And, it was actually faster to bike to every Apple store in Manhattan than to call them.</p>

<p>It wasn’t until two weeks after that when I drove up to New Hampshire to see my sister that I was finally able to get one.  I called her campus book store, and they had everything in stock.  And to boot, there’s no sales tax there.  A 10-minute phone call (and a five-hour drive I was making anyway) later, I finally had an iPad.  Such an ordeal!</p>

<p>In the end, I wonder, why does Apple make it so hard to love them?  All I want to do is buy their latest polished turd of a device.  That said, I really have been enjoying the hell out of it.  But the spite is growing, Apple.  The spite is growing.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/13/promises-to-my-os-prof/">Promises to My OS Prof</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-13T00:00:00-07:00" pubdate data-updated="true">Aug 13<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For me, operating systems was one of the most worth-while courses in my undergraduate career.  Not only gaining insight into the black-box that can be the operating system, but learning a bunch of skills that I have found invaluable since then.</p>

<p>Even in graduate school, I encounter computer scientists that have never used the command line.  While its all well and good to use your IDE, it is absolutely crippling to not be able to do all the same magics from the command line.  Not only that, but there is a wealth of tools accessible from your favorite shell and bash scripting is a useful piece to keep in one’s toolbox.  The command line was one thing with which I was better acquainted through operating systems; this was especially true in one project where we had to roll our own shell.  This was particularly good because the shell gives access to a lot of system tools that I’ve since found I want to use in other programs: forking, dup’ing, interacting with environment variables, etc.</p>

<p>Other good experiences were working with threading libraries and even booting up EC2 instances and testing out code there.  I am extremely grateful to then-professor Mike Colagrosso for making it such a worthwhile experience.  Lately I’ve been working with code where I remember quality code promises he made us make:</p>

<p><strong>ALWAYS save the return value of system calls.</strong>  I try to avoid programming in C as much as possible (after all, C++ is usually an alternative, if not Python), but whenever I do I am constantly reminded of this one.  The most common design for functions that I encounter in that kind of code is to accept the variable that is to be updated, and return instead, a code indicating the success/failure/warnings/etc. of the code.  In some cases, the return value is the only way you’ll have access to the resource just requested (for example in the case of fork(2) ), but either way it’s the basic mechanism for getting feedback about how code has executed.</p>

<p><strong>NEVER use strcpy(3).</strong> I’ve never used a buffer overflow in a clever way (though this is a someday project), or I should say on purpose.  But I’ve dealt with enough instances of me being distracted and writing bad code that I’ve gotten to know gdb (the GNU DeBugger) better than I would like.  The strcpy(3) function relies on null character termination to stop copying memory from one string into another.  If, however, a string isn’t null terminated or isn’t terminated before the length of the string buffer being copied into, then the operation will overrun the buffer.  Instead, <strong>ALWAYS use strncpy(3)</strong>.  It allows you to specify the maximum length that should be copied (like, for instance the length of the buffer being copied into) so as to avoid this embarrassing problem.</p>

<p>Despite the taking the class just over three years ago (it’s unsettling to realize its been so long), these few promises have stuck with me.  So Mike, if you’re reading this, I’m doing my part!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/04/a-bad-first-instinct/">A Bad First Instinct</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-04T00:00:00-07:00" pubdate data-updated="true">Aug 4<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It’s an itch.  A compulsion.  Sometimes when working with a new library I get a very strong impulse to do a very bad thing – reinvent the wheel.  Or, in this case, re-write the wheel.</p>

<p>It’s easy to object to the way code is organized, and can cause a certain amount of discomfort.  Whether it’s the desire to go through and reformat code (braces belong on the same line as the if statement!) or the pain of hacking together relatively incompatible library designs, it can be unpleasant.</p>

<p>Something that I’ve been pushing myself to do, and slowly learning to do is to be comfortable with that discomfort.  To resist the urge to rewrite code, as it’s never just a matter of rewriting it, but also testing it, an so forth.  I’m slowly beginning to accept the painful truth: no code is perfect.</p>

<p>That said, there are times when I do rewrite libraries.  Sometimes you’re handed code from ten years ago that’s no longer applicable, or antiquated, or just plain ugly.  In these scenarios it’s perfectly justified to make large sweeping structural changes (with the protection of your favorite version control, of course).  Just, hold off.  Wait, and try to use the library, and the first-pass issues will either grow into systemic problems or wither and recede into the cracks.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/03/channel-islands-national-park/">Channel Islands National Park</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-03T00:00:00-07:00" pubdate data-updated="true">Aug 3<span>rd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last week I was in Los Angeles, CA for SIGGRAPH, and though I discovered that I far prefer New York to LA (sorry, Angelinos) I did get something great out of it – a trip to Channel Islands National Park.</p>

<p>About 30,000 visitors step onto its shores every year, making it one of the least-visited national parks.  It consists of five islands of varying sizes, and we stayed on one of the larger ones.  There were a few dozen other campers we saw, but the vast majority of people on the boat were day-trippers.</p>

<iframe width="590" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.com/maps/ms?ie=UTF8&amp;hl=en&amp;t=h&amp;msa=0&amp;msid=104143756793913968082.00048cf5d071b3373ec9d&amp;ll=34.043557,-119.805908&amp;spn=0.796545,1.620483&amp;z=9&amp;output=embed"></iframe>
<p><br /><small>View <a href="http://maps.google.com/maps/ms?ie=UTF8&amp;hl=en&amp;t=h&amp;msa=0&amp;msid=104143756793913968082.00048cf5d071b3373ec9d&amp;ll=34.043557,-119.805908&amp;spn=0.796545,1.620483&amp;z=9&amp;source=embed" style="text-align:left">Channel Islands National Park Trip</a> in a larger map</small></p>

<p>We “set sail” at 8 am with <a href="http://www.islandpackers.com/">Island Packers</a>, who were fantastically efficient and a pleasure to travel with despite their apparent monopoly on service out to the islands.  Upon landing, the campers were required to get a brief orientation from the live-in park ranger describing their pack-in pack-out policy and the fact that we should never leave zippers exposed as the island’s ravens have learned to unzip backpacks.</p>

<p>With wetsuits rented from <a href="http://www.venturadive.com/">Ventura Dive and Sport</a>, plunged into the icy waters (ok, they’re not icy, but they’re pretty frigid compared to the warm Red Sea).  The kelp beds were amazing, stretching below beyond visibility and then tangling at the surface, creating an enormous labyrinth of giant leaves.  Their bases covered in sea urchins eating away at the tendrils.  On the second day we saw a couple of stingrays, and a school of fish thousands strong trolling the area.  I had hoped to swim and play with the local sea lions, but they weren’t particularly interested in us apparently.</p>

<p>While not freezing in the water, we hiked the many trails, perching atop the various cliffs overlooking the many harbors.  And when not hiking, we ate and watched the chihuahua-sized island foxes looking for food and fending off the comparably-sized ravens.</p>

<p><a href="http://www.flickr.com/photos/danlecocq/4858699346/" title="panorama2 by danlecocq, on Flickr"><img src="http://farm5.static.flickr.com/4138/4858699346_9f72fb0111.jpg" width="500" height="125" alt="panorama2" class="aligncenter" /></a></p>

<p>It was a fun excursion, and I hope to go back for more diving and exploration of the islands.  During the year they see countless whales and dolphins, and organize dive trips.  Oddly enough, I found out about it two years ago from an in-flight magazine on my way to a KAUST orientation meetup.  Chalk one up to the in-flight magazine!</p>

<p>I must admit, at times, looking down at the bright blue water, and ships coming into harbor, I felt a little bit like a pirate.</p>

<p><a href="http://www.flickr.com/photos/danlecocq/4857595030/" title="DSC_0097.NEF by danlecocq, on Flickr"><img src="http://farm5.static.flickr.com/4140/4857595030_e455bac17e.jpg" width="500" height="334" alt="DSC_0097.NEF" class="aligncenter" /></a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/02/webglot-high-performance-visualization-in-the-browser/">WebGLot - High Performance Visualization in the Browser</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-02T00:00:00-07:00" pubdate data-updated="true">Aug 2<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This last week saw SIGGRAPH 2010 in Los Angeles, sunny California.  It was there that I gave my first talk at a real conference.  One request that I had not anticipated was for the <a href="http://dan.lecocq.us/wordpress/wp-content/uploads/2010/08/siggraph2010-webglot.pdf">slides from the talk</a>, and so I post them here now.</p>

<p>Pending some red tape resolution, I hope to post the live-working demos soon.  Until then, I hope that this video from the original conference submission will whet your appetite!</p>

<object width="590" height="369"><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="http://vimeo.com/moogaloop.swf?clip_id=9584857&amp;server=vimeo.com&amp;show_title=1&amp;show_byline=1&amp;show_portrait=0&amp;color=00ADEF&amp;fullscreen=1" /><embed src="http://vimeo.com/moogaloop.swf?clip_id=9584857&amp;server=vimeo.com&amp;show_title=1&amp;show_byline=1&amp;show_portrait=0&amp;color=00ADEF&amp;fullscreen=1" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="590" height="369" /></object>

<p>For those particularly curious, feel free to contact me or refer to the <a href="http://portal.acm.org/citation.cfm?id=1837072">abstract</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/07/25/siggraph-2010/">SIGGRAPH 2010</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-25T00:00:00-07:00" pubdate data-updated="true">Jul 25<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I arrived in Los Angeles yesterday to attend (and talk at) SIGGRAPH 2010.  This is not the first time the conference has been here, but it is certainly my first time to this smoggy city.</p>

<p>Adjacent to the Los Angeles Convention Center is the Staples Center, where workers have been setting up for the X Games.  Fortunately they won’t begin until July 29th, the last day of this conference, but in watching the setup I was imagining an enormous re-enactment of high school stereotypes.  Tens of thousands of jocks right next door to tens of thousands of nerds.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/07/15/an-explanation-of-gpus-anyone-would-love/">An Explanation of GPUs Anyone Would Love</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-15T00:00:00-07:00" pubdate data-updated="true">Jul 15<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It’s a question that comes up often in conversation, and especially when meeting new people.  The normal pleasantries of where one is from and what one does naturally lead there.  “High-Performance Computing, eh?  What’s that?”</p>

<p>I sometimes feel it a mission to dispel myths about supercomputing that the layperson might have.  Pop culture is full of stern-looking authority figures leering at a screen, looking over the shoulder of an endearingly-disheveled nerd.  Or I think Chuck represents this well:</p>

<object width="600" height="475"><param name="movie" value="http://www.youtube.com/v/hNYbw3ZqzQw&amp;hl=en_US&amp;fs=1?rel=0" /><param name="allowFullScreen" value="true" /><param name="allowscriptaccess" value="always" /><embed src="http://www.youtube.com/v/hNYbw3ZqzQw&amp;hl=en_US&amp;fs=1?rel=0" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="600" height="475" /></object>

<p>So when answering this seemingly question about what exactly my job entails, I have to start at the bottom, explaining how processors aren’t getting any faster (and haven’t been for quite a while, relatively speaking).  And how this fact necessitates a different way of looking at programming tasks, moving from “fast” or “deep” to “wide.”  Supercomputers aren’t single small boxes in the middle of a vast room covered in billions of pixels, as Chuck would seem to suggest.  No, nothing so glamorous.  In fact, seeing a rack of IBM’s Blue Gene is more akin to <em>2001: A Space Odyssey</em> - being confronted with a towering black monolith:</p>

<p>[caption id=”attachment_875” align=”aligncenter” width=”300” caption=”The BlueGene/P system at Argonne National Lab.  The man in the picture is actually now an awesome system administrator for the KAUST Supercomputing Lab!”]<a href="http://www.alcf.anl.gov/news/media_files/bluegene_p.jpg"><img src="http://dan.lecocq.us/wordpress/wp-content/uploads/2010/07/bluegene_p-300x198.jpg" alt="" title="bluegene_p" width="300" height="198" class="size-medium wp-image-875" /></a>[/caption]</p>

<p>So modern supercomputers are not a single chip that can perform trillions of calculations per second, but are rather a set of relatively simple processors that each perform modestly.  Though when working in concert, the results are astounding.  Not long ago a supercomputer sustained calculations at a rate of 1 <a href="http://en.wikipedia.org/wiki/Petaflop">petaflop</a>, or a million billion operations every second.  If we were to compare that to a relatively modern desktop, a second on that computer is the equivalent of about <em>four days</em> of computation on your desktop.  If the same code were to run on the <a href="http://en.wikipedia.org/wiki/Apollo_Guidance_Computer">computers used in the Apollo missions</a>, it would take approximately 630 years (this is a rough approximation based on a figure of 20 microseconds per add).</p>

<p>The reason for the modest clock rates of each processor in modern devices is power.  Intel successfully grew processor performance by increasing the rate at which operations were performed (among other advances), but at a great cost in power.  For example, a chip on a BlueGene/P compute node runs at a mere 850MHz, though it’s impossible to use this number alone to compare performance.  In fact, of the budget allocated for the purchase of a system like that, only half that money goes towards actual equipment.  The rest goes towards the power of not only running it, but cooling the damn thing off.</p>

<p>Graphics cards have become an unlikely source of high-performance computing in the last ten years or so.  It’s seen many struggles, from being difficult to program and even harder to debug, to early cards not supporting floating-point calculations and not supporting certain types of loops.  And yet NVIDIA now markets a graphics card with as many as 480 cores.</p>

<p>I recently happened upon this video of Jamie Hyneman and Adam Savage of Myth Busters explaining the difference between a CPU (the brain of your computer for the uninitiated) and a GPU (the part the handles much of the graphics).  When presented with explosions, robots and paintballs, the difference really lights up (skip to 8 minutes in for the <em>really</em> good bit, but the whole thing is worth a watch):</p>

<object width="600" height="475"><param name="movie" value="http://www.youtube.com/v/XtGf0HaW7x4&amp;hl=en_US&amp;fs=1?rel=0" /><param name="allowFullScreen" value="true" /><param name="allowscriptaccess" value="always" /><embed src="http://www.youtube.com/v/XtGf0HaW7x4&amp;hl=en_US&amp;fs=1?rel=0" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="600" height="475" /></object>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/07/14/modules-your-friend-in-package-management/">Modules - Your Friend in Package Management</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-14T00:00:00-07:00" pubdate data-updated="true">Jul 14<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’ve been working with a large shared system at my school, sometimes building packages for myself and sometimes for others.  The one thing that’s almost certain across all such installations is that it’s difficult.  Installing dependencies can be a very deep rabbit hole, and there are seemingly more configuration, build and source control systems than there are atoms in the universe.</p>

<p>On this particular shared system, our awesome sysadmins (these guys are really pretty great!) use a package called <a href="http://modules.sourceforge.net/">modules</a> to set environment variables for use with various packages.  Suppose you have several versions of a library that you’re working with.  Let’s say some users need Python 2.4, and other 2.6 and 3.0.  Instead of managing your path yourself, modules can help:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$&gt;</span> module load python-2.4
</span><span class="line"><span class="nv">$&gt;</span> which python
</span><span class="line">/opt/share/python/2.4/ppc64/bin/python
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>One of the really great things about modules is that the way so-called <a href="http://modules.sourceforge.net/man/modulefile.html">modulefiles</a> are written, not only can you load modules easily, but you can also <em>unload</em> them just as easily:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$&gt;</span> which python
</span><span class="line">/opt/share/python/2.4/ppc64/bin/python
</span><span class="line"><span class="nv">$&gt;</span> module unload python-2.4
</span><span class="line"><span class="nv">$&gt;</span> module load python-2.6
</span><span class="line"><span class="nv">$&gt;</span> which python
</span><span class="line">/opt/share/python/2.6/ppc64/bin/python
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>It’s of course not limited to any particular environment variable.  The modulefile can specify where the man pages are, what paths to include when using <a href="http://www.cmake.org/">cmake</a>, dynamic library path and whatever you’d like.</p>

<p>Modulefiles are also extremely convenient places to store information on how you actually built the library.  When you come back to it three months from now to build the next version of some code base, you won’t remember the complex arguments you had to pass into configure or cmake in order to get the damned thing to build.  Build notes are an essential part of maintaining code, especially if other people will be using the libraries you’ve built.</p>

<p>Speaking of which, I’ve worked on other shared systems before where several people need to use the same library and end up building it separately.  Frank and Steve both need libX, and have made their installations accessible to the other users on the system, but who wants to sully their .bash_profile by adding some long and ugly paths to their PATH?  If Steve makes his modulefiles directory public, too, then you can just that directory in MODULEPATH:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="c"># in ~/.bash_profile</span>
</span><span class="line">...
</span><span class="line"><span class="nb">export </span><span class="nv">MODULEPATH</span><span class="o">=</span>~/modules/:/home/frank/modules/
</span><span class="line">...
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Perhaps it’s not the best thing since sliced bread, but I like that it affords me a way to bridge the gap between having a convention for where libraries are installed (say, if you use MacPorts, for example?) and being able to easily set all your environment variables to <em>easier</em> if not easy compilation.</p>

<p>By way of a way that its helped me, I’ve been compiling quite a few projects recently that rely on cmake.  These projects also have a whole lot of dependencies, but my build process is now something along the lines of:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$&gt;</span> module load libxml2
</span><span class="line"><span class="nv">$&gt;</span> module load vtk
</span><span class="line"><span class="nv">$&gt;</span> module load osmesa
</span><span class="line"><span class="nv">$&gt;</span> ...
</span><span class="line"><span class="nv">$&gt;</span> cmake ~/ParaView
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>This, compared to:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">CMAKE_INCLUDE_PATH</span><span class="o">=</span><span class="nv">$CMAKE_INCLUDE_PATH</span>:/opt/share/libxml2/2.7.7/ppc64/include:/opt/share/vtk/5.6.0/ppc64/include/:...<span class="se">\</span>
</span><span class="line"><span class="nv">CMAKE_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$CMAKE_LIBRARY_PATH</span>:/opt/share/libxml2/2.7.7/ppc64/include:/opt/share/vtk/5.6.0/ppc64/lib/:...<span class="se">\</span>
</span><span class="line">cmake ~/ParaView
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Computers aren’t perfect, but they are experts at remembering the details.  Almost to a fault.  Modules helps my interactions to be a little more equitable where I have to remember the important parts (the names of the modules I need, for example) and the computer can keep track of where the hell I put everything!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/07/13/delicious-sushi/">Delicious Sushi</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-13T00:00:00-07:00" pubdate data-updated="true">Jul 13<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’m not quite sure what the message here is.
[caption id=”attachment_870” align=”aligncenter” width=”225” caption=”Freshest dolphin in town?”]<a href="http://dan.lecocq.us/wordpress/wp-content/uploads/2010/07/IMG_0111.jpg"><img src="http://dan.lecocq.us/wordpress/wp-content/uploads/2010/07/IMG_0111-225x300.jpg" alt="" title="Dolphin sushi" width="225" height="300" class="size-medium wp-image-870" /></a>[/caption]</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/07/11/socket-to-me/">Socket to Me</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-11T00:00:00-07:00" pubdate data-updated="true">Jul 11<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’m not a “network guy.”  I still don’t know what exactly the subnet mask means, and I am often thankful that OS X is so willing to automatically configure network settings for me well.</p>

<p>That said, recently I’ve been finding myself doing a lot of programming with sockets.  They provide a low-level network interface to communicate between computers, and are used like other file descriptors.  On the C side of things there’s a little more work than I’d like, and as such, I’ve found Python an invaluable tool.</p>

<p>In fact, I think any time you’re working with a new concept, technique or algorithm it’s extremely helpful to use a scripting language.  Like others, Python offers an interactive session where you can develop code fragments by trial and error with each step, rather than trying to debug a chunk of code you’ve written with only a vague notion of what’s going on behind the scenes.  It allows you to pause between steps and see the effects and results of each function.</p>

<p>Interestingly enough, another tool has come in extremely handy - netcat.  It’s designed to print to stdout everything that it hears on the socket, and then it sends everything it receives on stdin through the socket.  It allows you to examine some of the specifics of a protocol without worrying about the details of your own code or whether or not your code works.  Netcat is tried and true, and will tell you exactly what’s happening.</p>

<p>This all came up in the context of WebSockets.  They’re a part of the HTML5 spec and provide a JavaScript interface for real socket communication (there are of course some caveats, especially with respect to how to handle binary data).  We’ve been using them for a project where we’d like the client to not need a special program to interact with a piece of software, and so instead implemented the protocol in JavaScript.</p>

<p>There was, however, some trouble at the offset.  I had a bit of difficulty finding out why exactly the WebSocket client would seem to start to make a connection but then immediately complain about handshakes.  What would have been much easier is to just open up netcat on the same port and have a conversation with the WebSocket itself.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># First off, I was running SimpleHTTPServer from a directory with a dummy html file</span>
</span><span class="line"><span class="err">$</span><span class="o">&gt;</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">SimpleHTTPServer</span> <span class="mi">8888</span>
</span><span class="line"><span class="c"># On the terminal, listen on port 35000</span>
</span><span class="line"><span class="err">$</span><span class="o">&gt;</span> <span class="n">netcat</span> <span class="o">-</span><span class="n">l</span> <span class="mi">35000</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>And then try to make a connection from the JavaScript side</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="err">#</span> <span class="nx">From</span> <span class="nx">a</span> <span class="nx">JavaScript</span> <span class="nx">terminal</span> <span class="nx">from</span> <span class="nx">that</span> <span class="nx">dummy</span> <span class="nx">html</span> <span class="nx">file</span><span class="p">,</span> <span class="k">in</span> <span class="nx">Chrome</span> <span class="nx">or</span> <span class="nx">Safari</span> <span class="k">for</span> <span class="nx">example</span>
</span><span class="line"><span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="s2">&quot;ws://localhost:35000&quot;</span><span class="p">);</span>
</span><span class="line"><span class="nx">ws</span><span class="p">.</span><span class="nx">onopen</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">);</span> <span class="p">};</span>
</span><span class="line"><span class="nx">ws</span><span class="p">.</span><span class="nx">onmessage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span> <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Received &quot;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span> <span class="p">};</span>
</span><span class="line"><span class="nx">ws</span><span class="p">.</span><span class="nx">onclose</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Goodbye!&quot;</span><span class="p">);</span> <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>I had figured (incorrectly) that WebSockets would work in essentially the exact same way that sockets would.  This is what we’d then expect to receive:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">GET</span> <span class="o">/</span> <span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
</span><span class="line"><span class="nx">Upgrade</span><span class="o">:</span> <span class="nx">WebSocket</span>
</span><span class="line"><span class="nx">Connection</span><span class="o">:</span> <span class="nx">Upgrade</span>
</span><span class="line"><span class="nx">Host</span><span class="o">:</span> <span class="nx">localhost</span><span class="o">:</span><span class="mi">35000</span>
</span><span class="line"><span class="nx">Origin</span><span class="o">:</span> <span class="nx">http</span><span class="o">:</span><span class="c1">//localhost:8888</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>It was only after realizing that this is what the WebSocket was sending that it became clear that the reason that no connection was actually happening was because the browser wasn’t getting the rest of <a href="http://www.whatwg.org/specs/web-socket-protocol/">the handshake</a>:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">101</span> <span class="nx">Web</span> <span class="nx">Socket</span> <span class="nx">Protocol</span> <span class="nx">Handshake</span><span class="err">\</span><span class="nx">r</span>
</span><span class="line"><span class="nx">Upgrade</span><span class="o">:</span> <span class="nx">WebSocket</span><span class="err">\</span><span class="nx">r</span>
</span><span class="line"><span class="nx">Connection</span><span class="o">:</span> <span class="nx">Upgrade</span><span class="err">\</span><span class="nx">r</span>
</span><span class="line"><span class="nx">WebSocket</span><span class="o">-</span><span class="nx">Origin</span><span class="o">:</span> <span class="nx">http</span><span class="o">:</span><span class="c1">//localhost:8888\r</span>
</span><span class="line"><span class="nx">WebSocket</span><span class="o">-</span><span class="nx">Location</span><span class="o">:</span> <span class="nx">ws</span><span class="o">:</span><span class="c1">//localhost:35000/\r</span>
</span><span class="line"><span class="nx">WebSocket</span><span class="o">-</span><span class="nx">Protocol</span><span class="o">:</span> <span class="nx">sample</span><span class="err">\</span><span class="nx">r</span><span class="err">\</span><span class="nx">n</span><span class="err">\</span><span class="nx">r</span><span class="err">\</span><span class="nx">n</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Oddly enough, I can’t seem to get netcat to play nice sending the response code, but it can easily-enough give us an indication of what was happening at first.  Python can handle the rest for us:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="err">$</span><span class="o">&gt;</span> <span class="n">python</span>
</span><span class="line"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">socket</span>
</span><span class="line"><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">()</span>
</span><span class="line"><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="mi">35000</span><span class="p">))</span>
</span><span class="line"><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class="line"><span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span><span class="line"><span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class="line"><span class="s">&#39;GET / HTTP/1.1</span><span class="se">\r\n</span><span class="s">Upgrade: WebSocket</span><span class="se">\r\n</span><span class="s">Connection: Upgrade</span><span class="se">\r\n</span><span class="s">Host: localhost:35000</span><span class="se">\r\n</span><span class="s">Origin: http://localhost:8888</span><span class="se">\r\n\r\n</span><span class="s">&#39;</span>
</span><span class="line"><span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;HTTP/1.1 101 Web Socket Protocol Handshake</span><span class="se">\r\n</span><span class="s">Upgrade: WebSocket</span><span class="se">\r\n</span><span class="s">Connection: Upgrade</span><span class="se">\r\n</span><span class="s">WebSocket-Origin: http://localhost:8888</span><span class="se">\r\n</span><span class="s">WebSocket-Location: ws://localhost:35000/</span><span class="se">\r\n</span><span class="s">WebSocket-Protocol: sample</span><span class="se">\r\n\r\n</span><span class="s">&#39;</span><span class="p">)</span>
</span><span class="line"><span class="mi">199</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>And notice that it’s not until the listening socket sends its response portion of the handshake that the JavaScript console will print the “hello” we told it to upon opening the connection.  Now that we have the two talking, let’s actually send and receive a couple of messages:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="err">#</span> <span class="nx">Again</span> <span class="nx">from</span> <span class="nx">the</span> <span class="nx">JavaScript</span> <span class="nx">console</span>
</span><span class="line"><span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;Hello from JavaScript!&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>And then we receive the message in Python:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class="line"><span class="s">&#39;</span><span class="se">\x00</span><span class="s">Hello from JavaScript!</span><span class="se">\xff</span><span class="s">&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>And here we find another oddity of WebSockets.  All messages seem to be prepended with \x00 and appended with \xff (though this is also mentioned in the specification).  If we try to send a message from Python without these two extra characters, we’ll get nothing out on the JavaScript side (go ahead and give it a try!):</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="err">#</span> <span class="nx">We</span> <span class="nx">get</span> <span class="nx">nothing</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">JavaScript</span> <span class="nx">side</span> <span class="o">:-</span><span class="err">/</span>
</span><span class="line"><span class="nx">client</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
</span><span class="line"><span class="err">#</span> <span class="nx">Magic</span> <span class="nx">happens</span><span class="o">!</span>
</span><span class="line"><span class="nx">client</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;\x00hello\xff&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Of course I’m sure there are other robust tools the real “networking guys” use to make their lives easier.  But outside of pulling up WireShark or trying to figure this out by writing C code, netcat and Python definitely saved the day.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/10/11/running-sudo-with-pssh/">Running sudo with pssh</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/21/rough-array-hash-benchmark/">Rough Array Hash Benchmark</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/20/taskmaster-from-disqus/">Taskmaster from DISQUS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/18/seomoz-blog-post-introducing-qless/">SEOmoz Blog Post &#8211; Introducing qless</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/11/redis-and-lua-for-robust-portable-libraries/">Redis and Lua for Robust, Portable Libraries</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/dlecocq">@dlecocq</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'dlecocq',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
